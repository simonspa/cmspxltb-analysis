<?xml version="1.0" encoding="us-ascii"?>
<!-- ?xml-stylesheet type="text/xsl" href="http://ilcsoft.desy.de/marlin/marlin.xsl"? -->
<!-- ?xml-stylesheet type="text/xsl" href="marlin.xsl"? -->


<!--###############################################
    #                                             #
    #     Example steering file for alignment     #
    #	  Version: $Id$                           #
    #                                             #
    ###############################################-->

<marlin xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://ilcsoft.desy.de/marlin/marlin.xsd">

  <execute>
    <processor name="AIDA"/>
    <processor name="LoadPreAlignment"/>
    <processor name="ApplyPreAlignment"/>
    <processor name="MyEUTelCorrelator"/>
    <processor name="Align"/>
    <processor name="MyEUTelUtilityPrintEventNumber"/>
  </execute>

  <global>
    <parameter name="LCIOInputFiles"> @LcioPath@/@FilePrefix@-hitmaker.slcio </parameter>
    <parameter name="GearXMLFile" value="@GeometryPath@/@GearFile@"/>
    <parameter name="MaxRecordNumber" value="@MaxRecordNumber@"/>
    <parameter name="SkipNEvents" value="0"/>
    <parameter name="SupressCheck" value="false"/>
    <parameter name="Verbosity"> @Verbosity@  </parameter> 
  </global>

  <processor name="AIDA" type="AIDAProcessor">
    <parameter name="Compress" type="int" value="1"/>
    <parameter name="FileName" type="string"> @HistogramPath@/@FilePrefix@-alignment </parameter>
    <parameter name="FileType" type="string" value="root"/>
  </processor>

  <processor name="LoadPreAlignment" type="ConditionsProcessor">
    <parameter name="DBInit" type="string" value="localhost:lccd_test:calvin:hobbes"/>
    <parameter name="SimpleFileHandler" type="StringVec"> prealign @DatabasePath@/@FilePrefix@-prealignment.slcio alignment </parameter>
  </processor>

  <processor name="ApplyPreAlignment" type="EUTelApplyAlignmentProcessor">
    <parameter name="AlignmentConstantName" type="string" lcioInType="LCGenericObject"> prealign </parameter>
    <parameter name="InputHitCollectionName" type="string" lcioInType="TrackerHit"> hit </parameter>
    <parameter name="OutputHitCollectionName" type="string" lcioOutType="TrackerHit"> prealignedhits </parameter>
    <parameter name="ApplyAlignmentDirection" type="int" value="0"/>
    <parameter name="CorrectionMethod" type="int" value="1"/>
    <parameter name="DoAlignCollection" type="bool" value="true"/>
    <parameter name="PrintEvents" type="int" value="10"/>
    <parameter name="alignmentCollectionNames" type="StringVec" value="prealign"/>
    <parameter name="hitCollectionNames" type="StringVec" value="hitCollectionNames"/>
    <parameter name="refhitCollectionNames" type="StringVec" value="hitCollectionNames"/>
  </processor>

  <processor name="MyEUTelCorrelator" type="EUTelCorrelator">
    <parameter name="InputClusterCollections" type="string" lcioInType="TrackerPulse"> </parameter>
    <parameter name="InputHitCollectionName" type="string" lcioInType="TrackerHit"> hit </parameter>
    <parameter name="ClusterChargeMinimum" type="int" value="2"/>
    <parameter name="DumpOffset" type="bool" value="true"/>
    <parameter name="Events" type="int" value="10000"/>
  </processor>

  <processor name="Align" type="EUTelMille">
    <parameter name="AlignmentConstantLCIOFile" type="string" value="@DatabasePath@/@FilePrefix@-alignment.slcio"/>
    <parameter name="BinaryFilename" type="string" value="@DatabasePath@/@FilePrefix@-align-mille.bin"/>
    <parameter name="PedeSteerfileName" type="string" value="@DatabasePath@/@FilePrefix@-pede-steer.txt"/>
    <parameter name="RunPede" type="int" value="1"/>
    <parameter name="UseResidualCuts" type="int" value="@UseResidualCuts@"/>
    <parameter name="ResidualsXMax" type="FloatVec"> @ResidualXMax@ </parameter>
    <parameter name="ResidualsXMin" type="FloatVec"> @ResidualXMin@ </parameter>
    <parameter name="ResidualsYMax" type="FloatVec"> @ResidualYMax@ </parameter>
    <parameter name="ResidualsYMin" type="FloatVec"> @ResidualYMin@ </parameter>
    <parameter name="HitCollectionName" type="string" lcioInType="TrackerHit"> prealignedhits </parameter>
    <parameter name="TrackCollectionName" type="string" lcioInType="Track"> fittracks </parameter>
    <parameter name="AlignMode" type="int" value="3"/>
    <parameter name="DistanceMax" type="float" value="@DistanceMax@"/>
    <parameter name="ExcludePlanes" type="IntVec">@ExcludePlanes@ </parameter>
    <parameter name="FixedPlanes" type="IntVec">@FixedPlanes@ </parameter>
    <parameter name="GeneratePedeSteerfile" type="int" value="1"/>
    <parameter name="InputMode" type="int" value="0"/>
    <parameter name="MaxTrackCandidates" type="int" value="@MaxTrackCandidates@"/>
    <parameter name="MaxTrackCandidatesTotal" type="int" value="@MaxTrackCandidates@"/>
    <parameter name="OnlySingleHitEvents" type="int" value="@OnlySingleHitEvents@"/>
    <parameter name="OnlySingleTrackEvents" type="int" value="@OnlySingleTrackEvents@"/>
    <!--<parameter name="FixParameter" type="int" value="28 28 28 28 28 28"/-->
    <!--<parameter name="FixParameter" type="int" value="0 0 0 0 0 0"/>-->
    <!--parameter name="FixParameter" type="int" value="63 63 63 63 63 63"/-->
    <parameter name="ResolutionX" type="FloatVec" value="18 18 18 18 18 18"/>
    <parameter name="ResolutionY" type="FloatVec" value="18 18 18 18 18 18"/>
    <parameter name="ResolutionZ" type="FloatVec" value="1 1 1 1 1 1"/>
    <parameter name="TelescopeResolution" type="float" value="10"/>
  </processor>

  <processor name="MyEUTelUtilityPrintEventNumber" type="EUTelUtilityPrintEventNumber">
    <parameter name="EveryNEvents" type="int" value="1000"/>
    <parameter name="printTimestamp" type="bool" value="false" />
  </processor>

</marlin>
